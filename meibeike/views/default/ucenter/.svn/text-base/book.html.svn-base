<style type="text/css">
.book_wrapper {float: left; width: 100%; background-color: rgb(244, 244, 244); padding-bottom: 30px;}	
.book_wrapper .book_content {width: 1200px; height: auto; margin: 0 auto;}
.book_wrapper .book_content #content_2 {display: none;}
.book_wrapper .book_content .header {float: left; width: 100%; height: 90px; line-height: 90px; margin-top: 10px; padding-left: 40px; font-size: 32px;}
.book_wrapper .book_content .content {float: left; width: 1120px; height: 720px; margin-left: 40px; border-radius: 5px; 
		   border: rgb(188, 188, 188) 1px solid; box-shadow: 0 0 5px rgb(180, 180, 180); background-color: #FFF;}
.book_wrapper .book_content .content .c_left {float: left; width: 694px; height: 640px; border-right: 1px rgb(217, 217, 217) solid; 
		background-color: rgb(252, 252, 252); border-top-left-radius: 5px; border-bottom-left-radius: 5px;}

.book_wrapper .book_content .content .c_left .ui-carousel { height: 100px; margin: 0; overflow: auto; padding: 0; position: relative;  width: 300px }
.book_wrapper .book_content .content .c_left .ui-carousel > .wrapper { margin: 0; padding: 0; width: 9999px; }
.book_wrapper .book_content .content .c_left .ui-carousel > .wrapper > * { border: 0; display: block; float: left; height: 100px; overflow: hidden; width: 100px; }			
.book_wrapper .book_content .content .c_left #container { float: left; width: 100%; height: 520px; position: relative;  margin: 0 auto; margin-top: 40px;  }			
.book_wrapper .book_content .content .c_left #carousel { float: left; position: relative; width: 410px; left: 135px; text-align: center; }			
.book_wrapper .book_content .content .c_left #ui-carousel-next, #ui-carousel-prev { width: 40px; height: 40px; background: url({skin:/images/front/arrow_left.png}) rgb(252, 252, 252) center center no-repeat;
	display: block; position: absolute; top: 235px;; z-index: 100; }
.book_wrapper .book_content .content .c_left #ui-carousel-next { right: 60px; background-image: url({skin:/images/front/arrow_right.png}); }
.book_wrapper .book_content .content .c_left #ui-carousel-prev { left: 45px; }			
.book_wrapper .book_content .content .c_left #ui-carousel-next > span, #ui-carousel-prev > span { display: none; }			
.book_wrapper .book_content .content .c_left .slide { float: left; width: 100%; height: 100%; text-align : center; margin: 0; position: relative; }						
.book_wrapper .book_content .content .c_left .slide > img { position: absolute; left: 0px; top: 0px; }
.book_wrapper .book_content .content .c_left #pages { width: 150px; margin: 0 auto; }		
.book_wrapper .book_content .content .c_left .bullet { display: block; width: 15px; height: 15px; margin-bottom: 0px; margin-right: 5px; margin-top: 10px; float: left;}
.book_wrapper .book_content .content .c_left .on {background: url({skin:images/front/page-on.png}) center center no-repeat; }
.book_wrapper .book_content .content .c_left .off {background: url({skin:images/front/page-off.png}) center center no-repeat; }


.book_wrapper .book_content .content .c_right {float: left; width: 420px; height: 640px;}
.book_wrapper .book_content .content .c_right .cr_title {float: left; margin-left: 20px; height: 94px;  width: 390px; border-bottom: 1px solid rgb(217, 217, 217);}
.book_wrapper .book_content .content .c_right .cr_title label {float: left; margin-left: 20px; margin-top: 30px;font-size: 28px; }
.book_wrapper .book_content .content .c_right .cr_title img {float: left; margin-top: 27px; margin-left: 10px;}

.book_wrapper .book_content .content .c_right .sel_color {float: left; width: 100%; height: 100px; line-height: 100px; font-size: 18px; text-align: center;}
.book_wrapper .book_content .content .c_right .sel_color .circle {float: left; margin-top: 27px; margin-right: 32px; width: 46px; height: 46px; border-radius: 25px; cursor: pointer;}
.book_wrapper .book_content .content .c_right .sel_color .circle_sub {float: left; width: 40px; height: 40px; border-radius: 18px;  margin: 3px;}
.book_wrapper .book_content .content .c_right .sel_color .left {float: left; text-align: left; margin-left: 40px; width: 110px;}
.book_wrapper .book_content .content .c_right .sel_cap {float: left; margin-left: 40px; width: 300px; height: 50px; line-height: 50px; font-size: 18px;}

.book_wrapper .book_content .content .c_right .sel_cap_cb {float: left; margin-left: 40px; width: 300px; line-height: 50px; font-size: 20px;}
.book_wrapper .book_content .content .c_right .sel_cap_cb label.out {float: left; margin-bottom: 20px; width: 358px; height: 66px; line-height: 66px; cursor: pointer; }
.book_wrapper .book_content .content .c_right .sel_cap_cb label.in_left {float: left; padding-left: 60px; }
.book_wrapper .book_content .content .c_right .sel_cap_cb label.in_right {float: right; padding-right: 25px; }
.book_wrapper .book_content .content .c_right .sel_cap_cb label.sel_on {color: #FFF; background: url({skin:images/front/cb_selected.png})}
.book_wrapper .book_content .content .c_right .sel_cap_cb label.sel_off {color: rgb(182, 188, 196); background: url({skin:images/front/cb_not_selected.png})}

.book_wrapper .book_content .content .c_right .jishu {float: left; margin-top: 25px; width: 360px; height: 50px; line-height: 26px; font-size: 14px; padding-left: 40px;}
.book_wrapper .book_content .content .c_right .zhifu {float: left; margin-top: 0px; width: 360px; height: 60px; line-height: 26px; font-size: 14px; padding-left: 40px;}

.book_wrapper .book_content .content .c_footer {float: left; width: 100%; height: 80px; border-top: 1px rgb(217, 217, 217) solid; 
		background-color: rgb(252, 252, 252); border-bottom-left-radius: 5px; border-bottom-right-radius: 5px;}

.book_wrapper .book_content .tech_rule {float: left; width: 1120px; margin-left: 40px; margin-top: 50px; border-radius: 5px; 
		   border: rgb(188, 188, 188) 1px solid; box-shadow: 0 0 5px rgb(180, 180, 180); background-color: #FFF;}
.book_wrapper .book_c.book_wrapper .book_content .step_div {float: left; width: 100%; height: 60px; margin-top: 50px;}			 
.book_wrapper .book_content .step_div img {margin-left: 32px;}
ontent .tech_rule .tr_header {float: left; width: 100%; border-top-left-radius: 5px; border-top-right-radius: 5px; 
		background-color: rgb(252, 252, 252); height: 70px; line-height: 70px; border-bottom: 1px solid rgb(217, 217, 217); font-size: 18px;}
.book_wrapper .book_content .tech_rule .tr_header label {margin-left: 35px;}
.book_wrapper .book_content .tech_rule .tr_color {float: left; padding-left: 32px; padding-top: 70px; margin-bottom: 50px;}
.book_wrapper .book_content .tech_rule .tr_color .trc_left {float: left; width: 300px; height: 330px; border-bottom: 1px solid rgb(217, 217, 217); font-size: 18px;padding-top: 20px; padding-left: 20px;}
.book_wrapper .book_content .tech_rule .tr_color .trc_right {float: left; width: 650px; height: 350px; margin-left: 90px; border-bottom: 1px solid rgb(217, 217, 217);}

.book_wrapper .book_content .tech_rule .tr_rule {float: left;  padding-left: 32px; margin-bottom: 50px; }
.book_wrapper .book_content .tech_rule .tr_rule .trr_left {float: left; width: 300px; height: 80px; padding-top: 20px; padding-left: 20px;  font-size: 18px; border-bottom: 1px solid rgb(217, 217, 217);}
.book_wrapper .book_content .tech_rule .tr_rule .trr_right {float: left; width: 650px; height: 100px; line-height: 25px; margin-left: 90px; border-bottom: 1px solid rgb(217, 217, 217);}



.book_wrapper .book_content .step_div {float: left; width: 100%; height: 60px; margin-top: 50px;}			 
.book_wrapper .book_content .step_div img {margin-left: 32px;}
.book_wrapper .book_content .address {float: left; width: 1120px; height: 370px; margin-left: 0; margin-bottom: 0; }
.book_wrapper .book_content .address .content {float: left; width: 100%; height: 370px; border-radius: 5px; border: 1px solid rgb(217, 217, 217); background-color: #FFF;}
.book_wrapper .book_content .address .content .ac_header {float: left; width: 100%; height: 60px; line-height: 60px; border-top-left-radius: 5px; border-top-right-radius: 5px; border-bottom: 1px solid rgb(217, 217, 217); background-color: rgb(252, 252, 252);}
.book_wrapper .book_content .address .content .ac_header label {margin-left: 30px;}
.book_wrapper .book_content .address .content .ac_header a {display: block; cursor: pointer; float: right; margin-right: 20px; margin-top: 12px; height: 36px; line-height: 36px; text-align: center; padding: 0 15px; border-radius: 3px; background-color: rgb(228, 228, 228);}
.book_wrapper .book_content .address .content .ac_body {float: left; padding-left: 60px; padding-top: 45px;}
.book_wrapper .book_content .address .content .ac_body input {float: left; font-size: 14px; padding-left: 10px; }
.book_wrapper .book_content .address .content .ac_body select {float: left; font-size: 14px; padding-left: 10px; }
.book_wrapper .book_content .address .content .ac_body label.col {float: left; width: 20px; height: 36px;}
.book_wrapper .book_content .address .content .ac_body label.row {float: left; width: 100%; height: 20px;}
.book_wrapper .book_content .address .content .ac_body label.row_s {float: left; width: 100%; height: 10px;}
.book_wrapper .book_content .address .content .ac_body .acb_left {float: left; width: 450px; height: 100%;}
.book_wrapper .book_content .address .content .ac_body .acb_right {float: left; margin-left: 90px; width: 400px;}

.book_wrapper .book_content .jianxi {float: left; width: 100%; height: 35px;}
.book_wrapper .book_content .bank {float: left; width: 1120px;; margin-left: 0; margin-bottom: 0;}
.book_wrapper .book_content .bank .content {float: left; width: 100%;  height: 230px; border-radius: 5px; border: 1px solid rgb(217, 217, 217); background-color: #FFF;}
.book_wrapper .book_content .bank .content .bc_header {float: left; width: 100%; height: 60px;; line-height: 60px; border-top-left-radius: 5px; border-top-right-radius: 5px; border-bottom: 1px solid rgb(217, 217, 217); background-color: rgb(252, 252, 252);}
.book_wrapper .book_content .bank .content .bc_header label {margin-left: 30px;}
.book_wrapper .book_content .bank .content .bc_header_2 {float: left; width: 100%; height: 65px; line-height: 65px; border-bottom: 1px solid rgb(217, 217, 217); background-color: rgb(252, 252, 252);}
.book_wrapper .book_content .bank .content .bc_header_2 label {margin-left: 10px;}
.book_wrapper .book_content .bank .content .bc_header_2 label input {margin-left: 20px; font-size: 14px;}

.book_wrapper .book_content .bank .content .banks {float: left; display: none; padding-left: 30px; padding-right: 20px; padding-top: 30px;}
.book_wrapper .book_content .bank .content .banks input {float: left; margin-top: 20px; margin-bottom: 20px;}
.book_wrapper .book_content .bank .content .banks img {float: left; margin-right: 40px;  margin-bottom: 20px;}

.book_wrapper .book_content .bank .content .zhifus {float: left; padding-left: 30px; padding-right: 20px; padding-top: 30px;}
.book_wrapper .book_content .bank .content .zhifus input {float: left; margin-top: 20px; margin-bottom: 20px;}
.book_wrapper .book_content .bank .content .zhifus img {float: left; margin-right: 40px;  margin-bottom: 20px;}

.book_wrapper .book_content .fapiao {float: left; width: 350px; height: 230px; margin-left: 0; margin-bottom: 0;}
.book_wrapper .book_content .fapiao .content {float: left; width: 100%; height: 230px; border-radius: 5px; border: 1px solid rgb(217, 217, 217); background-color: #FFF;}
.book_wrapper .book_content .fapiao .content .fc_header {float: left; width: 100%; height: 60px; line-height: 60px; border-top-left-radius: 5px; border-top-right-radius: 5px; border-bottom: 1px solid rgb(217, 217, 217); background-color: rgb(252, 252, 252);}
.book_wrapper .book_content .fapiao .content .fc_header label {margin-left: 30px;}
.book_wrapper .book_content .fapiao .content .line_1 {float: left; width: 100%; line-height: 40px; height: 40px; padding-left: 30px;} 
.book_wrapper .book_content .fapiao .content .line_1 img {float: left; margin-top: 15px; margin-right: 10px;}
.book_wrapper .book_content .fapiao .content .line_1 label {float: left; margin-top: 10px;}
.book_wrapper .book_content .fapiao .content .line_1 input {display: none;}

.book_wrapper .book_content .remark {float: left; width: 740px; height: 230px; margin-left: 30px; margin-bottom: 0;}
.book_wrapper .book_content .remark .content {float: left; width: 100%; height: 230px; border-radius: 5px; border: 1px solid rgb(217, 217, 217); background-color: #FFF;}
.book_wrapper .book_content .remark .content .rc_header {float: left; width: 100%; height: 60px; line-height: 60px; border-top-left-radius: 5px; border-top-right-radius: 5px; border-bottom: 1px solid rgb(217, 217, 217); background-color: rgb(252, 252, 252);}
.book_wrapper .book_content .remark .content .rc_header label {margin-left: 30px;}

.book_wrapper .book_content .sel_address {float: left; display: none; width: 1120px; margin-left: 40px; border-radius: 8px; 
		   border: rgb(188, 188, 188) 1px solid; box-shadow: 0 0 5px rgb(180, 180, 180); background-color: #FFF; }
.book_wrapper .book_content .sel_address .number {float: left; width: 100%; height: 50px; line-height: 50px; color: rgb(121, 121, 121);
			border-top-left-radius: 8px; border-top-right-radius: 8px; background-color: rgb(252, 252, 252);}
.book_wrapper .book_content .sel_address .number label {float: left; margin-left: 30px;}
.book_wrapper .book_content .sel_address .number a {display: block; cursor: pointer; float: right; margin-right: 20px; margin-top: 7px; height: 36px; line-height: 36px; text-align: center; padding: 0 15px; border-radius: 3px; background-color: rgb(228, 228, 228);}
.book_wrapper .book_content .sel_address table {float: left; width: 100%; margin-bottom: 10px; }	
.book_wrapper .book_content .sel_address table tr.first {background-color: rgb(230, 231, 232); line-height: 40px; }
.book_wrapper .book_content .sel_address table tr {background-color: #FFF; line-height: 100px; }
.book_wrapper .book_content .sel_address table td, th {text-align: left; font-family: normal;}



</style>

<div class="book_wrapper">
	<div class='book_content'>
            <form action="{url:/ucenter/book2}" method='post' id="order_form" >
                <input type='hidden' name='goods_id' id='goods_id' value='{$id}' />
                <input type='hidden' name='product_id' id='product_id' value='0' />
                <input type='hidden' name='goods_nums' id='goods_nums' value='1' />
                <input type='hidden' name='goods_price' id='goods_nums' value='{$sell_price}' />
                <input type='hidden' name='timeKey' value='{echo:time()}' />
		<div id="content_1">
			<div class='header'>
				{$name}
			</div>
			<div class="content">
				<div class="c_left">
					<div id="container">
						<div id="carousel">
                                                    {foreach: items = $photo key=$k item=$v}
							<div id="slide{$k}" class="slide">
                                                            {set:$tmpimg = $v['img']}
								<img height="520" width="410" src="{webroot:$tmpimg}" alt="test_pro" />
							</div>
                                                    {/foreach}
						</div>
						<a href="#" id="ui-carousel-next"><span>next</span></a>
						<a href="#" id="ui-carousel-prev"><span>prev</span></a>
						<div id="pages"></div>
					</div>
				</div>
				<div class="c_right">
					<div class="cr_title">
						<img src="{skin:images/front/u73.png}" />
						<label>选择你的<font style="color: rgb(239, 123, 162)">{$name}</font></label>
					</div>
                                   
					<div class="sel_color">
                                            <input type='hidden' id='colorselected' value='0' />
						<label class="left" style="">选择颜色：</label>
                                                {foreach:items=$spec_array}
                                                {if:$item['name'] == '颜色'}
                                                {set:$specVal=explode(',',trim($item['value'],','))}
					        {foreach:items=$specVal item=$spec_value key=$k}
						<div class="circle" id='circle_{$k}' cid="{$k}" style="border: 2px rgb(229, 229, 229) solid;">
							<div class="circle_sub" style="background-color: {$spec_value};"></div>
                                                        <input type="hidden" name="color" value='{"id":"{$item['id']}","type":"{$item['type']}","value":"{$spec_value}","name":"{$item['name']}"}' />
						</div>
                                                {/foreach}
                                                {/if}
                                                {/foreach}
					</div>
					<div class="sel_cap">
						选择容量：
					</div>
                                        <input type='hidden' id='volumeselected' value='0' />
					<div class="sel_cap_cb">
                                            {foreach: items = $volume key=$k item=$v}
						<label class="out sel_off" id='volume_{$k}'>
							<label class="in_left">{$v["value"]}</label>
							<label class="in_right">￥{$v["price"]}</label>
                                                        <input type="hidden" name="volume" value='{"id":"{$v['id']}","type":"{$v['type']}","value":"{$v['value']}","name":"{$v['name']}"}' />
						</label>
                                            {/foreach}
					</div>
					<div class="jishu">
						<label>产品说明产品说明产品说明产品说明</label>
						<a style="text-decoration: none; color: rgb(4, 177, 255);">技术规格</a>
					</div>
					<div class="zhifu">
						<label>支付说明支付说明支付说明支付说明支付说明支付说明支付说明支付说明支付说明</label>
						<a style="text-decoration: none; color: rgb(4, 177, 255);">了解更多</a>
					</div>
				</div>
				<div class="c_footer">
					<img  style="float: left; margin-top: 10px; margin-left: 25px" src="{webroot:$img}" height="62" width="66">
					<label style="float: left; height: 62px; line-height: 62px; margin-top: 10px; margin-left: 25px;"><font style="color: rgb(239, 123, 162)">{$name}</font></label> 
					<a id="to_second_page" style="float: right; height: 40px; line-height: 40px; width: 130px; text-align: center; background-color: rgb(253, 101, 97); color: #FFF; font-size: 18px; cursor: pointer; border-radius: 4px; margin-top: 22px; margin-right: 25px;">下一步</a>
				</div>
			</div>
			<div class="tech_rule">
				<div class="tr_header">
					<label>技术规格</label>
				</div>
				<div class="tr_color">
					<div class="trc_left">颜色</div>
					<div class="trc_right">
						{set:$item_index=0}
						{foreach: items = JSON::decode($attribute[0]["value"])}

						<img src="{webroot:$item}" <?php if(++$item_index<2) { ?>style="margin-right: 50px;"<?php } ?>/>
						{/foreach}
					</div>
				</div>
				<div class="tr_rule">
					<div class="trr_left">技术规格</div>
					<div class="trr_right">
						{$content}
					</div>
				</div>
			</div>
		</div>
	

		<div id="content_2">
			<div class="step_div">
				<img src="{skin:images/front/second_step_bg.png}"/>
			</div>
			<div class="jianxi"></div>

			<div class='sel_address'>
				<div class='number'>
                                    {set:$order_no = Order_Class::createOrderNum()}
                                    <input type="hidden" name="order_no" value="{$order_no}">
					<label>订单号: &nbsp; {$order_no}</label>
					<a id="use_new_addr">使用新地址</a>
				</div>
                                <input id='address_id' type='hidden' name='address_id' value='0' />
				<table  cellspacing="0">
					<tr class="first">
						<th width="80"></th>
						<th width="120">姓名</th>
						<th width="570">详细地址</th>
						<th width="150">配送时间</th>
						<th>电话</th>
					</tr>
                                        {set: $user_id = $this->user['user_id']}
                                        {query:name=address where=user_id eq $user_id}
					<tr class="">
                                            {set: $area = area::name($item['province'], $item['city'], $item['area'])}
						<td style="text-align: center;"><!--label style="float: left; margin-left: 30px; width: 20px; height: 20px; background: url({skin:images/front/blue_sel.png});"></label-->
                                                <img  class="address_select" src="{skin:images/front/unselected.png}" style="float: left; margin-top: 0px; margin-left: 30px;"/>
                                                <input name="tpl_accept_name" type="hidden" value="{$item['accept_name']}" />
                                                <input name="tpl_zip" type="hidden" value="{$item['zip']}" />
                                                <input name="tpl_telphone" type="hidden" value="{$item['telphone']}" />
                                                <input name="tpl_province" type="hidden" value="{$item['province']}" />
                                                <input name="tpl_city" type="hidden" value="{$item['city']}" />
                                                <input name="tpl_area" type="hidden" value="{$item['area']}" />
                                                <input name="tpl_address" type="hidden" value="{$item['address']}" />
                                                <input name="tpl_mobile" type="hidden" value="{$item['mobile']}" />
                                                <input name="tpl_accept_time" type="hidden" value="{$item['accept_time']}" />
                                                <input name="tpl_default" type="hidden" value="{$item['default']}" />
                                                </td>
						<td>{$item['accept_name']}</td>
						<td>{$area[$item['province']]}{$area[$item['city']]}{$area[$item['area']]}{$item['address']}</td>
                                                <td>{$item["accept_time"]}</td>
						<td>{if:$item['mobile']}{$item['mobile']}{else:}{$item['telphone']}{/if}</td>
						<!--td style="text-align: center;"><label style="float: left; margin-left: 40px; width: 40px; height: 40px; background: url({skin:images/front/edit_bg.png});"></label></td-->
					</tr>
                                        {/query}
				</table>
			</div>		
			<div class="address">
				<div class="content">
					<div class="ac_header">
						<label>收货信息</label>
						<a id="select_addr">选择已有地址</a>
					</div>
					<div class="ac_body">
						<div class="acb_left">
							<input type="text" name="accept_name" maxlength="10" value="" class="order_required order_string" alt="请填写收货人" placeholder="收货人姓名" style="width: 180px; height: 36px;"/><label class="col"></label>
							<input type="text" name="mobile" maxlength="20" value="" class="order_string" placeholder="手机号" style="width: 250px; height: 36px;"/><label class="row"></label>
							<input type="text" name="postcode" maxlength="10" value="" class="order_string" placeholder="邮编(可选)" style="width: 125px; height: 36px;"/><label class="col"></label>
							<input type="text" name="telphone" maxlength="20" value="" class="order_string" placeholder="固定电话(可选)" style="width: 305px; height: 36px;"/><label class="row"></label>
                                                        <select style="width: 163px; height: 36px;" name="province" child="city,area" onchange="areaChangeCallback(this);"></select></select><label class="col"></label>
                                                        <select style="width: 143px; height: 36px;" name="city" child="area" parent="province" onchange="areaChangeCallback(this);"></select><label class="col"></label>
						        <select style="width: 104px; height: 36px;" class="order_required"  name="area" parent="city" alt="请选择收货地区"></select>
                                                        <label class="row"></label>
							<input type="text" name="address" maxlength="60" value="" class="order_required order_string" alt="请填写详细地址" placeholder="街道编号/名称、楼宇名称" style="width: 450px; height: 36px;"/>
						</div>
						<div class="acb_right">
                                                    <input type="hidden" class="order_required" name="accept_time" alt="请选择送货方案" value="">
							<label style="float: left; font-size: 16px; width: 100%; line-height: 25px;">送货方案</label>
							<label style="float: left; font-size: 14px; width: 100%; line-height: 25px;">您的订购在配货前，可以访问&nbsp;<font style="color: rgb(13, 122, 255)">我的订单</font>&nbsp;修改收货地址</label>
							<label class="row_s"></label>
							<label class="sh_time" style="float: left; width: 200px; height: 52px; line-height: 20px; cursor: pointer; padding-top: 13px; border: 1px rgb(223, 223, 223) solid; font-size: 14px; background-color: rgb(250, 250, 250);">
								<div style="margin-left: 53px;"><font style="font-size: 16px; font-weight: 800;">不限送货时间</font><br>周一至周日</div>
                                                                <input type="hidden" name="sh_time_value" value="不限送货时间" />
							</label>
							<label class="col"></label>
							<label class="sh_time" style="float: left; width: 200px; height: 52px; line-height: 20px; cursor: pointer; padding-top: 13px; border: 1px rgb(223, 223, 223) solid; font-size: 14px; background-color: rgb(250, 250, 250);">
								<div style="margin-left: 53px;"><font style="font-size: 16px; font-weight: 800;">工作日送货</font><br>周一至周五</div>
                                                                <input type="hidden" name="sh_time_value" value="周一至周五" />
							</label>
							<label class="row_s"></label>
							<label class="sh_time" style="float: left; width: 200px; height: 52px; line-height: 20px; cursor: pointer; padding-top: 13px; border: 1px rgb(223, 223, 223) solid; font-size: 14px; background-color: rgb(250, 250, 250);">
								<div style="margin-left: 53px;"><font style="font-size: 16px; font-weight: 800;">双休日、假日送货</font><br>周六至周日</div>
                                                                <input type="hidden" name="sh_time_value" value="周六至周日" />
							</label>
						</div>
					</div>
				</div>
			</div>
			<div class="jianxi"></div>
                        <input type="hidden" name="pay_type" class="order_required" alt="请选择支付方式" value="" />
			<div class="bank">
				<div class="content" id="bank_content">
					<div class="bc_header">
						<label>支付方式</label>
					</div>
					<div class="bc_header_2">
						<label>
							<img id="zhifu_id" class="img_select" src="{skin:images/front/selected.png}" style="float: left; margin-top: 16px; margin-left: 30px;"/><label style="float: left; margin-right: 10px;">支付平台</label>
							<img id="banks_id" class="img_select" src="{skin:images/front/unselected.png}" style="float: left; margin-top: 16px;"/><label style="float: left;">银联支付</label>
						</label>
					</div>
					<div class="banks">
						<?php for ($i = 1; $i <= 14; $i++) { ?>
						<input type="radio" name="zhifu"/><img width="150" height="48" src="{skin:images/front/bank/b_$i.png}"/>
						<?php } ?>
					</div>
					<div class="zhifus">
						{query:name=payment where=status eq 0 }
						<input type="radio" name="zhifu" onchange="choose_me({$item['id']})"/><img width="150" height="48" src="{webroot:}plugins/{$item['logo']}"/>
						{/query}
					</div>
				</div>
			</div>
			<div class="jianxi"></div>
			<div class="fapiao">
				<div class="content">
					<div class="fc_header">
						<label>发票信息</label>
					</div>
					<div class="line_1">
						<img src="{skin:images/front/u610.png}"/><label>普通发票</label>
					</div>
                                    <input type="hidden" id="invoice_type" name="invoice_type" value="1">
					<div class="line_1">
						<label style="margin-left: 40px;">发票抬头：</label>
						<img class="img_select" id="personal" src="{skin:images/front/selected.png}"/><label style="margin-right: 10px;">个人</label>
						<img class="img_select" id="company" src="{skin:images/front/unselected.png}"/><label>单位</label>
					</div>
					<div class="line_1">
						<input id="company_info" name="invoice_title" type="text" value="" class="order_string" style="float: left; display: none; margin-left: 40px; margin-top: 20px; width: 270px; height: 40px; border: 1px solid rgb(188, 188, 188); border-radius: 6px; font-size: 16px;"/>
					</div>
				</div>
			</div>
			<div class="remark">
				<div class="content">
					<div class="rc_header">
						<label>特别提示</label>
					</div>
					<label style="float: left; line-height: 30px; font-size: 14px; margin-top: 20px; margin-left: 30px;">
						1.提交订单后，选购的产品配置不可更改。如果选择错误，您可以取消订单重新购买<br>
						2.请您在提交订单后24小时内完成支付，否则订单会自动取消。
					</label>
				</div>
			</div>

			<div class="next_footer" style="float: left; width: 1120px; margin-left: 40px; margin-top: 30px; height: 80px; border: 1px rgb(217, 217, 217) solid;box-shadow: 0 0 5px rgb(180, 180, 180);  background-color: rgb(252, 252, 252); border-radius: 5px;">
				<img  style="float: left; margin-top: 10px; margin-left: 25px" src="{webroot:$img}" height="62" width="66">
				<label style="float: left; height: 62px; line-height: 62px; margin-top: 10px; margin-left: 25px;"><font style="color: rgb(239, 123, 162)">{$name}</font></label> 
				<a id="to_third_page" style="float: right; height: 40px; line-height: 40px; width: 130px; text-align: center; background-color: rgb(253, 101, 97); color: #FFF; font-size: 18px; cursor: pointer; border-radius: 4px; margin-top: 22px; margin-right: 25px;">下一步</a>
			</div>

		</div>
	</div>
	

</div>

<div class="sure_order_bg" style="position: absolute; z-index: 80000; top: 0; left: 0; margin-left: 0; margin-top: 0; display: none; width: 100%; background: #000; filter:alpha(opacity=50); -moz-opacity:0.5; -khtml-opacity: 0.5; opacity: 0.5;"></div>
<div class="sure_order" style="display: none; position: absolute; left: 300px; width: 700px; height: 440px; background-color: #FFF; border-radius: 5px; z-index: 90000;">
	<div class="so_header" style="float: left; height: 50px; line-height: 50px; width: 100%; border-top-left-radius: 5px; border-top-right-radius: 5px; background-color: rgb(252, 252, 252); border-bottom: 1px solid rgb(215, 215, 215);">
		<label style="float: left; margin-left: 30px;">确认信息</label>
	</div>
	<div class="so_body1" style="float: left; height: 175px; width: 100%;border-bottom: 1px solid rgb(215, 215, 215);">
		<div class="sob_left" style="float: left; margin-left: 40px; margin-top: 20px; margin-right: 30px;"><img src="{skin:images/front/car.png}"/></div>
		<div class="sob_right" style="float: left; margin-top: 20px; font-size: 14px; line-height: 28px;">
			<label><font style="font-size: 16px">收货信息</font><br><div id="sure_address"></div></label>
		</div>
	</div>
	<div class="so_body2" style="float: left; height: 155px; width: 100%;border-bottom: 1px solid rgb(215, 215, 215);">
		<div class="sob_left" style="float: left; margin-left: 40px; margin-top: 20px; margin-right: 30px;"><img src="{skin:images/front/money.png}"/></div>
		<div class="sob_right" style="float: left; margin-top: 40px; font-size: 14px; line-height: 28px;">
                    <label><font style="font-size: 16px">发票信息</font><div id="sure_invoice"></div></label>
		</div>
	</div>
	<div class="so_footer" style="float: left; width: 100%; height: 60px; background-color: rgb(252, 252, 252); border-bottom-left-radius: 5px; border-bottom-right-radius: 5px; ">
		<a class="a_button" id="cancel_form" style="float: left; cursor: pointer; margin-left: 20px; display: block; width: 100px; height: 36px; line-height: 36px; margin-top: 10px;border-radius: 5px; text-align: center;">取消</a>
		<a class="a_button" id="submit_form" style="float: right; cursor: pointer; margin-right: 20px; background-color: rgb(252, 62, 57); color: #FFF; margin-top: 10px; display: block; width: 100px; height: 36px; line-height: 36px; border-radius: 5px; text-align: center;">确认</a>
	</div>
</div>
{js:artTemplate}
<script type='text/javascript' src='{theme:javascript/artTemplate/area_select.js}'></script>
<script type="text/javascript" src="{theme:javascript/jquery.switch/jquery-1.7.1.js}"></script>
<script type="text/javascript" src="{theme:javascript/jquery.switch/jquery.ui.core.js}"></script>
<script type="text/javascript" src="{theme:javascript/jquery.switch/jquery.ui.widget.js}"></script>
<script type="text/javascript" src="{theme:javascript/jquery.switch/jquery.ui.rcarousel.js}"></script>
<script type='text/javascript' src='{theme:javascript/orderFormClass.js}'></script>
<script type="text/javascript">
    //初始化地址选择
    createAreaSelect('province',0,'');
    $('[name="city"]').empty();
    $('[name="area"]').empty();
    template.compile("areaTemplate",areaTemplate);
    
    //支付类型选择
    function choose_me($id){
        $("input[name='pay_type']").val($id);
    }
    
    /**
 * 检查规格选择是否符合标准
 * @return boolen
 */
function checkSpecSelected()
{
	if($('#colorselected').val() != 0 && $('#volumeselected').val() != 0)
	{
		return true;
	}
	return false;
}

/**
 * 设置产品信息
 */
function initProductInfo(){
    //检查规格是否选择符合标准
	if(checkSpecSelected())
	{
		//整理规格值
		var specArray = [];
                var color_id =$("#colorselected").val();
                specArray.push($("#"+color_id).children("input").val());
		var volume_id = $("#volumeselected").val();
                specArray.push($("#"+volume_id).children("input").val());
		var specJSON = '['+specArray.join(",")+']';
                //alert(specJSON);

		//获取货品数据并进行渲染
		$.getJSON('{url:/site/getProduct}',{"goods_id":"{$id}","specJSON":specJSON,"random":Math.random},function(json){
			if(json.flag == 'success')
			{
				//普通货品数据渲染
				$('#product_id').val(json.data.id);

			}
			else
			{
                            window.scrollTo(0,100);
				alert(json.message);
				closeBuy();
			}
		});
	}
}
    
    /**
 * 生成地域js联动下拉框
 * @param name
 * @param parent_id
 * @param select_id
 */
function createAreaSelect(name,parent_id,select_id)
{
        
	//生成地区
	$.getJSON("{url:/block/area_child}",{"aid":parent_id,"random":Math.random()},function(json)
	{
		$('[name="'+name+'"]').html(template.render('areaTemplate',{"select_id":select_id,"data":json}));
	});
}
	function adjust_sure_box(to_show) {
		if (to_show) {
                    //sure_box信息装入
                    //发票信息
                    var invoice_type = $("#invoice_type").val();
                    if(invoice_type == 1){
                        //个人
                        var invoice = "普通发票：个人<br />";
                    }else{
                        //公司
                        var invoice = "普通发票：公司<br />"+$("[name='invoice_title']").val();
                    }
                    $("#sure_invoice").html(invoice);
                    
                    //地址信息
                    var accept_name = $("[name=accept_name]").val();
                    if($("[name=mobile]").val()){
                        var tel = $("[name=mobile]").val();
                    }else{
                        var tel = $("[name=telphone]").val();
                    }
                    var province = $("[name=province]").val();
                    var city = $("[name=city]").val();
                    var area = $("[name=area]").val();
                    var address_detail = $("[name=address]").val();
                    $.getJSON("{url:/block/area_name}",{province:province, city:city, area:area},function(json){
                        //alert(json);
                        province = json.province;
                        city = json.city;
                        area = json.area;
                        
                        var accept_time = $("[name=accept_time]").val();
                        var address = accept_name+","+tel+"<br />"+province+" "+city+" "+area+ "<br />" + address_detail + "<br />"+accept_time+" 收货";
                        $("#sure_address").html(address);
                        
                        
                        
                        var win_height = parseInt($(window).height());
			var win_width  = parseInt($(window).width());

			var sh = document.body.scrollTop;

			var box_top = sh + (win_height - 440) / 2;
			var box_left = (win_width - 700) / 2 ;

			$(".sure_order").css("top", box_top);
			$(".sure_order").css("left", box_left);
			$(".sure_order_bg").css("top", sh);
			$(".sure_order_bg").css("height", win_height);

			$(".sure_order").css("display","block");
			$(".sure_order_bg").css("display","block");

			$("body").eq(0).css("overflow", "hidden");
                    })
		} else {
			$("body").eq(0).css("overflow", "");
			$(".sure_order").css("display","none");
			$(".sure_order_bg").css("display","none");
		}
	}
	
	
	
	jQuery(function($) {	
		$("#cancel_form").click(function() {
			adjust_sure_box(0);
		});
                $("#submit_form").click(function() {
                        adjust_sure_box(0);
			$("#order_form").submit();
                        //dopay();
		});
		
		$("#to_second_page").click(function() {
                    if(checkSpecSelected()){
			$("#content_1").css("display", "none");
			$("#content_2").css("display", "block");
			$('html, body').animate({scrollTop:0}, 'slow');
                    }else{
                        window.scrollTo(0,100);
                        alert("请选择商品规格！");
                    }
		});
		
		$("#to_third_page").click(function() {
                    //消息验证
                    var failed = 0;
                    //必填字段验证
                    $("input.order_required").each(function(){
                        if($(this).val()=='' || $(this).val()==0){
                            window.scrollTo(0,100);
                            alert($(this).attr("alt"));
                            failed = 1;
                            return ;
                        }
                    })
                    //防JS注入
                    var pattern = /[<>]+/i;
                    $("input.order_string").each(function(){
                        if($(this).val().search(pattern) != -1){
                            window.scrollTo(0,100);
                            alert("存在非法字符，请重新输入!");
                            failed = 1;
                            return ;
                        }
                    })
                    
                    //确认信息
                    if(failed == 0){
                        adjust_sure_box(1);
                    }
		});
		
		$("a#select_addr").click(function() {
			$("div.address").css("display", "none");
			$("div.sel_address").css("display", "block");
		});
		$("a#use_new_addr").click(function() {
                        //清空地址选择ID
                        $("[name='address_id']").val(0);
			$("div.address").css("display", "block");
			$("div.sel_address").css("display", "none");;
		});
		
		$(".img_select").click(function() {
			$(this).attr("src", "{skin:images/front/selected.png}");
			$(this).siblings(".img_select").attr("src", "{skin:images/front/unselected.png}");
			
			if ($(this).attr("id") == "personal") {
                            //个人发票选中
                             $("#invoice_type").val(1);
				$("#company_info").css("display", "none");
			} else if ($(this).attr("id") == "company") {
                            //公司发票选中
                            $("#invoice_type").val(2);
				$("#company_info").css("display", "block");
			} else if ($(this).attr("id") == "zhifu_id") {
				$(".banks").css("display", "none");
				$(".zhifus").css("display", "block");
				$("#bank_content").css("height", "230px");
			} else {
				$(".banks").css("display", "block");
				$(".zhifus").css("display", "none");
				$("#bank_content").css("height", "370px");
			}
			
			
		});
		
		$(".sh_time").click(function() {
                    //设置送货值
                    var accept_time = $(this).children("input[name='sh_time_value']").val();
                    $("input[name='accept_time']").val(accept_time);
                    
			$(this).css("border-color", "rgb(255, 72, 0)");
			$(this).css("background-color", "rgb(255, 255, 255)");
			
			$(this).siblings(".sh_time").css("border-color", "rgb(223, 223, 223)");
			$(this).siblings(".sh_time").css("background-color", "rgb(250, 250, 250)");
		});
		
		// 圆圈
                // 颜色选择
		$(".circle").click(function() {
                    
                    //样式渲染
			var cid = $(this).attr("cid");
			if (cid == "0") {
				$(this).css("border-color", "rgb(13, 122, 255)");
				$(this).siblings(".circle").css("border-color", "rgb(229, 229, 229)");
			} else {
				$(this).css("border-color", "rgb(13, 122, 255)");
				$(this).siblings(".circle").css("border-color", "rgb(255, 255, 255)");
			}
                    //逻辑数据
                    $("#colorselected").val(this.id);
                    initProductInfo();
                    
		});
		
		// 容量
		$(".sel_cap_cb > .out").click(function() {
			$(this).removeClass("sel_off");
			$(this).addClass("sel_on");
			
			$(this).siblings("label").removeClass("sel_on");
			$(this).siblings("label").addClass("sel_off");
                        
                        //逻辑数据
                    $("#volumeselected").val(this.id);
                    initProductInfo();
		});
                
                //初始化地址
                $(".address_select").each(function(){
                    if($(this).nextAll("[name='tpl_default']").val() == 1){
                        address_choose(this);
                    }
                });
                
                //选择已有地址
                $(".address_select").click(function(){
	            address_choose(this);
                });
                
                //选择地址
                function address_choose(obj){
                    $(".address_select").attr("src", "{skin:images/front/unselected.png}");
                    $(obj).attr("src", "{skin:images/front/selected.png}");
                    
                    //把地址填充到表单中
                    $("[name=accept_name]").val($(obj).nextAll("[name=tpl_accept_name]").val());
                    $("[name=postcode]").val($(obj).nextAll("[name=tpl_zip]").val());
                    $("[name=telphone]").val($(obj).nextAll("[name=tpl_telphone]").val());
                    $("[name=province]").val($(obj).nextAll("[name=tpl_province]").val());
                    $("[name=city]").val($(obj).nextAll("[name=tpl_city]").val());
                    $("[name=area]").val($(obj).nextAll("[name=tpl_area]").val());
                    $("[name=address]").val($(obj).nextAll("[name=tpl_address]").val());
                    $("[name=mobile]").val($(obj).nextAll("[name=tpl_mobile]").val());
                    
                    $("[name=accept_time]").val($(obj).nextAll("[name=tpl_accept_time]").val());
                    
                    //重新生成地区
                    createAreaSelect('province',0,$(obj).nextAll("[name=tpl_province]").val());
                    createAreaSelect('city',$(obj).nextAll("[name=tpl_province]").val(),$(obj).nextAll("[name=tpl_city]").val());
                    createAreaSelect('area',$(obj).nextAll("[name=tpl_city]").val(),$(obj).nextAll("[name=tpl_area]").val());
                    
                    //送货时机
                    var sh_time = $("[name='sh_time_value'][value='"+$(obj).nextAll("[name=tpl_accept_time]").val()+"']").parents(".sh_time");
                    sh_time.css("border-color", "rgb(255, 72, 0)");
                    sh_time.css("background-color", "rgb(255, 255, 255)");
                    sh_time.siblings(".sh_time").css("border-color", "rgb(223, 223, 223)");
                    sh_time.siblings(".sh_time").css("background-color", "rgb(250, 250, 250)");
                }
		
		// 轮换代码
		function generatePages() {
			var _total, i, _link;

			_total = $( "#carousel" ).rcarousel( "getTotalPages" );
			
			$("#pages").css("width", (20 * _total).toString() + "px");
			
			for ( i = 0; i < _total; i++ ) {				
				_link = $( "<a href='#'></a>" );
				
				$(_link)
					.bind("click", {page: i},
						function( event ) {
							$( "#carousel" ).rcarousel( "goToPage", event.data.page );
							event.preventDefault();
						}
					)
					.addClass( "bullet off" )
					.appendTo( "#pages" );
			}

			// mark first page as active
			$( "a:eq(0)", "#pages" )
				.removeClass( "off" )
				.addClass( "on" )
				;

		}

		function pageLoaded( event, data ) {
			$( "a.on", "#pages" )
				.removeClass( "on" )
				.css( "background", "url({skin:images/front/page-off.png})  center center no-repeat" );

			$( "a", "#pages" )
				.eq( data.page )
				.addClass( "on" )
				.css( "background", "url({skin:images/front/page-on.png})  center center no-repeat" );
		}

		$("#carousel").rcarousel(
			{
				visible: 1,
				step: 1,
				speed: 700,
				auto: {
					enabled: false
				},
				width: 410,
				height: 520,
				start: generatePages,
				pageLoaded: pageLoaded
			}
		);

		$( "#ui-carousel-next" )
			.add( "#ui-carousel-prev" )
			.add( ".bullet" )
			.hover(
				function() {
					$( this ).css( "opacity", 0.7 );
				},
				function() {
					$( this ).css( "opacity", 1.0 );
				}
			);
	});
        
        // 支付等待
function dopay()
{
	confirm('支付是否成功',"window.location.href='{url:/ucenter/book_result}';");
}
</script>
